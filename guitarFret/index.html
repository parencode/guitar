<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='utf-8'>
<title>Visualización de acordes de guitarra</title>
<script src='./js/d3.v7.min.js'></script>
<script src='./js/tone.js'></script>
<style>body{font-family:Arial,Helvetica,sans-serif;font-size:16px;line-height:1.5;color:#333;background-color:#fff}.pentagrama{stroke:#000;stroke-width:2}.string{stroke:#000;stroke-width:2}.dot{fill:#000}#guitar-neck{width:90vw;height:18rem;margin:0 auto}label{display:inline-block;margin-bottom:10px}input[type=range]{width:14rem}output{margin-top:5px;margin-left:5px;font-size:18px}.ios-btn{font-size:16px;padding:10px 20px;background-color:#007aff;color:#fff;border:none;border-radius:20px;margin-bottom:10px}div,svg{margin:0 0;padding:0 0}.hidden{display:none}.info-button{font-size:24px;font-weight:700;cursor:pointer}.info-popup{display:inline;position:absolute;top:50px;left:50px;background-color:#fff;padding:10px;z-index:999;opacity:1}.popup{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#000;z-index:9999;display:flex;justify-content:center;align-items:center;opacity:1}.popup-content{position:relative;max-width:90%;max-height:80%;overflow-y:auto;background-color:#fff;padding:1rem;border-radius:.5rem;box-shadow:0 0 10px rgba(0,0,0,.5)}.close-btn{position:absolute;top:.5rem;right:.5rem;font-size:1.5rem;font-weight:700;color:#333;background-color:transparent;border:none;cursor:pointer}.popup.active{pointer-events:auto}.popup.active .popup-content{animation:fadeIn .3s ease-in-out forwards}@keyframes fadeIn{from{opacity:0;transform:translateY(-50px)}to{opacity:1;transform:translateY(0)}}.notesScales{pointer-events:none}#drag-boton{background-color:#4caf50;border:none;color:#fff;padding:4px;text-align:center;text-decoration:none;display:inline-block;font-size:12px;margin:0 0;cursor:pointer;border-radius:8px}#drag-boton.activo{background-color:#f44336}</style>
	<link rel="icon" href="./images/cropped-universoMini_logo3-1-32x32.png" sizes="32x32" />
<link rel="icon" href="./images/cropped-universoMini_logo3-1-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="./images/cropped-universoMini_logo3-1-180x180.png" />
<meta name="msapplication-TileImage" content="./images/cropped-universoMini_logo3-1-270x270.png" />
</head>
<body>
<div class='info-button' style='position:absolute'>?</div>
<div class='info-popup'>
<div class='popup'>
<div class='popup-content'>
<button class='close-btn'>&times;</button>
<div style='margin:0 auto;width:500px'>
<div style='text-align:center'>
<a href='https://www.periodicspace.com/' class='custom-logo-link' rel='home' itemprop='url'><img width='250' height='250' src='./images/cropped-universoMini_logo3.png' class='custom-logo' alt='' itemprop='logo' srcset='./images/cropped-universoMini_logo3.png 250w, ./images/cropped-universoMini_logo3-150x150.png 150w, ./images/cropped-universoMini_logo3-100x100.png 100w' sizes='100vw'></a><br>
© 2018 Periodic Space<br>
<h1 style='text-align:center'>La guitarra</h1>
</div>
<p>La guitarra está formada por 6 cuerdas, desde la 1ª, la más fina, abajo del mástil, hasta la 6ª, la más gruesa, arriba del mástil.</p>
<p>Y por 12 trastes en la guitarra española y 24 trastes en algunas guitarras eléctricas.</p>
<p>Cada cuerda al aire tiene una nota, y cuando pisamos un traste de una cuerda cambiamos la nota que suena.</p>
<p>Aquí cada nota tiene un color, y se ha representado cada traste de la guitarra por un rectángulo de color, indicando la nota de cada traste.</p>
<p>Seleccionando la nota deseada, podemos:</p>
<ul>
<li>Visualizar los distintos acordes: mayor, menor, dim7, etc., mostrando distintas posiciones de ejecución del acorde en diferentes posiciones del mástil.
<ul>
<li>Muestra las posiciones de cada dedo en los diferentes trastes, 1 índice, 2 corazón, 3 anular, 4 meñique.</li>
<li>Las cejuelas se indican con ceros en el traste correspondiente.</li>
</ul>
</li>
<li>Visualizar distintas escalas en la nota deseada.
<ul>
<li>Muestra la nota dominante con un círculo, y en las escalas de 7 notas, muestra los grados correspondientes.</li>
</ul>
</li>
<li>Visualizador en el pentagrama de las escalas.
<ul>
<li>No muestra los acordes, ¿te atreves a pintarlos?</li>
<li>Un clic en el pentagrama dibuja la nota correspondiente, otro clic la borra.</li>
</ul>
</li>
<li>Visualizador del círculo de quintas.</li>
</ul>
<p>Referencia a los datos de las escalas:</p>
<ul>
<li><a href='https://gist.github.com/guitarpickfm/2caf3f4ecc6efd7f07df958b1a245b8e'>https://gist.github.com/guitarpickfm/2caf3f4ecc6efd7f07df958b1a245b8e</a></li>
<li>Usuario: <a href='https://gist.github.com/guitarpickfm'>https://gist.github.com/guitarpickfm</a></li>
</ul>
<p>Un gran sitio para los acordes es donde he sacado los datos:</p>
<ul>
<li><a href='https://tombatossals.github.io/react-chords/guitar'>https://tombatossals.github.io/react-chords/guitar</a></li>
<li>Referencia a los datos de los acordes: <a href='https://github.com/tombatossals/chords-db/blob/master/lib/guitar.json'>https://github.com/tombatossals/chords-db/blob/master/lib/guitar.json</a></li>
<li>Usuario: <a href='https://github.com/tombatossals'>https://github.com/tombatossals</a></li>
</ul>
<p>proyecto realizado en d3.js</p>
<h1 style='text-align:center'>Secretos</h1>
<ul>
<li>deslizador de escalas: desliza un símbolo de las escalas y traslada la escala a través del mástil.</li>
<li>esconder escala: Haz clic en el título de la escala para ocultarla en el mástil. Para mostrar la escala, selecciónala en el selector de escalas donde dice Common, Intervals, Chords...</li>
<li>Cada color en el mástil representa un sonido. Haz clic para probar y escuchar los diferentes sonidos.</li>
<li>Dibuja una nota en el pentagrama haciendo clic y borra la nota haciendo clic en la nota dibujada. Compara sonidos y octavas.</li>
<li>Encuentra un secreto seleccionando la 5º octava.</li>
<li>Mueve el círculo de quintas seleccionándolo y arrastrándolo, o haz clic para cambiar su posición.</li>
<li>Dibuja una nota en el pentagrama haciendo clic y borra la nota haciendo clic en la nota dibujada. Compara sonidos y octavas.</li>
<li>Sistema para Guitalete: seleciona frets 8, y disfruta de un guitalele</li>
</ul>
<h1 style='text-align:center'>Escalas</h1>
<p>
La escala de doce notas es comúnmente conocida como la escala cromática. En esta escala, se divide la octava en doce semitonos iguales, lo que significa que hay doce notas diferentes en la escala. Cada nota en la escala cromática tiene un nombre único y se puede identificar por su altura de tono exacta, que es la distancia entre cada nota.
</p>
<p>Las escalas musicales son una serie de notas ordenadas en intervalos específicos que se utilizan como base para crear la armonía y la melodía en la música. La música occidental utiliza principalmente escalas diatónicas de siete notas, también conocidas como modos, que son la base de la mayoría de los géneros musicales populares. Cada modo tiene su propio sonido característico y se utiliza para crear diferentes estados de ánimo y emociones en la música.</p><p>La escala mayor, también conocida como modo jónico, es una de las escalas más comunes en la música occidental y se utiliza para crear una sensación brillante, feliz y optimista. Otras escalas modales comunes incluyen la escala menor natural, también conocida como modo eólico, que tiene un sonido oscuro y melancólico, y la escala mixolidia, que tiene un toque de blues y se utiliza a menudo en la música popular y en el rock.</p><p>Las escalas modales menos comunes incluyen la escala locria, que tiene un sonido tenso e inquietante, y la escala lidia, que tiene un sonido brillante y exótico. Cada escala modal tiene su propio conjunto de notas y se utiliza para crear diferentes estados de ánimo y emociones en la música.</p>
<p>Las escalas musicales son una serie de notas que se utilizan como base en la música. Cada escala se compone de una serie de notas, ordenadas según su altura o frecuencia. Hay muchas escalas diferentes en la música, cada una con su propia sensación y sonido únicos.</p><p>La escala diatónica es la escala musical más común en la música occidental. Está formada por siete notas y se utiliza para componer la mayoría de la música tonal. Las siete notas de la escala diatónica son la tónica, la segunda, la tercera, la cuarta, la quinta, la sexta y la séptima.</p><p>Además de la escala diatónica, existen escalas musicales que utilizan notas adicionales, como la escala cromática. La escala cromática utiliza todas las notas de la octava, incluyendo los semitonos (o notas "negras" en un teclado). Esta escala se utiliza a menudo para crear efectos de tensión o para transiciones entre diferentes tonalidades.</p><p>Otras escalas musicales importantes incluyen la escala pentatónica (que utiliza solo cinco notas), la escala blues (que utiliza notas de la escala pentatónica con notas adicionales de blues), la escala mayor armónica (que incluye una séptima mayor) y la escala menor melódica (que tiene una sexta y séptima ascendentes). Cada escala tiene su propio carácter y se utiliza para crear diferentes tipos de música, desde la música clásica hasta el jazz y el rock.</p>
<ul>
<li>Ionian: también conocida como escala mayor, es una escala diatónica de siete notas que se utiliza en la música occidental. Tiene una sensación brillante, feliz y optimista, y se utiliza a menudo para transmitir sentimientos de alegría y celebración.</li>
<li>Dorian: es una escala modal menor que se utiliza a menudo en el jazz y en la música popular. Tiene un sonido suave, melancólico y con un toque de misterio, y se utiliza a menudo para crear un ambiente relajado y tranquilo.</li>
<li>Phrygian: es una escala modal menor que tiene un sonido intenso, dramático y exótico. Tiene una sensación oscura y pesada, y se utiliza a menudo para crear una atmósfera de tensión y suspense en la música.</li>
<li>Lydian: es una escala modal mayor que tiene un sonido brillante, exótico y con un toque de misterio. Tiene una sensación de aventura y exploración, y se utiliza a menudo para crear una sensación de emoción y energía en la música.</li>
<li>Mixolydian: es una escala modal mayor que tiene un sonido distinto y con un toque de blues. Tiene una sensación de relajación y comodidad, y se utiliza a menudo en la música popular y en el rock para crear un ambiente divertido y de fiesta.</li>
<li>Aeolian: también conocida como escala menor natural, es una escala diatónica de siete notas que se utiliza a menudo en la música clásica y en el rock. Tiene un sonido oscuro, melancólico y triste, y se utiliza a menudo para expresar sentimientos de dolor y angustia.</li>
<li>Locrian: es una escala modal menor que tiene un sonido tenso, inquietante y disonante. Tiene una sensación de inestabilidad y conflicto, y se utiliza a menudo para crear una atmósfera de tensión y suspense en la música.</li>
</ul>
<h1 style='text-align:center'>Acordes</h1>
<p>Los acordes en la guitarra se forman a partir de la combinación de notas individuales tocadas simultáneamente. Un acorde puede estar formado por tres o más notas y se construye a partir de la escala diatónica de la tonalidad de la canción.</p><p>Los acordes mayores están formados por la primera, tercera y quinta nota de la escala mayor. Por ejemplo, el acorde de C mayor se compone de las notas C, E y G.</p><p>Los acordes menores están formados por la primera, tercera menor y quinta nota de la escala menor natural. Por ejemplo, el acorde de A menor se compone de las notas A, C y E.</p><p>Existen otros tipos de acordes como los acordes séptima, novena, disminuidos, aumentados y muchos otros, que se construyen a partir de diferentes combinaciones de notas.</p><p>En la guitarra, se pueden tocar los acordes de varias maneras, como en posición abierta, posición cejuela o posición en traste. La posición abierta es aquella en la que se utilizan cuerdas al aire y los primeros trastes para formar los acordes. La posición en cejuela se refiere a la utilización de la cejuela para tocar acordes con notas más altas. Por último, la posición en traste se utiliza para tocar acordes en posiciones más altas del mástil de la guitarra.</p>
<h1 style='text-align:center'>The Guitar</h1>
<p>The guitar is made up of 6 strings, from the 1st, the thinnest, at the bottom of the fretboard, to the 6th, the thickest, at the top of the fretboard.</p>
<p>And by 12 frets on the Spanish guitar and 24 frets on some electric guitars.</p>
<p>Each string has a note when played open, and when we press a fret on a string, we change the note that sounds.</p>
<p>Here each note is assigned a color, and each fret of the guitar is represented by a colored rectangle, indicating the note of each fret.</p>
<p>By selecting the desired note, we can:</p>
<ul>
<li>Visualize different chords: major, minor, dim7, etc., showing different chord voicings in different positions on the fretboard.
<ul>
<li>Shows the finger positions on different frets, 1 index, 2 middle, 3 ring, 4 pinky.</li>
<li>The capo is indicated with zeros on the corresponding fret.</li>
</ul>
</li>
<li>Visualize different scales on the desired note.
<ul>
<li>Shows the dominant note with a circle, and in 7-note scales, shows the corresponding degrees.</li>
</ul>
</li>
<li>Visualizer on the staff of the scales.
<ul>
<li>Does not show the chords, dare to color them yourself?</li>
<li>A click on the staff draws the corresponding note, another click erases it.</li>
</ul>
</li>
<li>Visualizer of the circle of fifths.</li>
</ul>
<p>Reference to the scale data:</p>
<ul>
<li><a href='https://gist.github.com/guitarpickfm/2caf3f4ecc6efd7f07df958b1a245b8e'>https://gist.github.com/guitarpickfm/2caf3f4ecc6efd7f07df958b1a245b8e</a></li>
<li>User: <a href='https://gist.github.com/guitarpickfm'>https://gist.github.com/guitarpickfm</a></li>
</ul>
<p>A great site for chords where I got the data:</p>
<ul>
<li><a href='https://tombatossals.github.io/react-chords/guitar'>https://tombatossals.github.io/react-chords/guitar</a></li>
<li>Reference to the chord data: <a href='https://github.com/tombatossals/chords-db/blob/master/lib/guitar.json'>https://github.com/tombatossals/chords-db/blob/master/lib/guitar.json</a></li>
<li>User: <a href='https://github.com/tombatossals'>https://github.com/tombatossals</a></li>
</ul>
<h1 style='text-align:center'>Secrets</h1>
<ul>
<li>Scale slider: Slide a symbol of the scales and shift the scale across the fretboard.</li>
<li>Hide scale: Click on the scale title to hide it on the fretboard. To show the scale, select it in the scale selector where it says Common, Intervals, Chords...</li>
<li>Each color on the fretboard represents a sound. Click to try and hear different sounds.</li>
<li>Draw a note on the staff by clicking and erase the note by clicking on the drawn note. Compare sounds and octaves.</li>
<li>Find a secret by selecting the 5th octave.</li>
<li>Move the circle of fifths by selecting it and dragging it, or click to change its position.</li>
<li>Draw a note on the staff by clicking and erase the note by clicking on the drawn note. Compare sounds and octaves.</li>
<li>Guitalete system: select frets 8 and enjoy a guitalele.</li>
</ul>
Note: Translated by ChatGPT Mar 14 Version: I am an AI language model and my translations may not be perfect. Please double-check the accuracy of the translations before using them.
<p>Project developed in d3.js</p>
<footer style='text-align:center'>
<p>
<a href='https://www.periodicspace.com/' class='custom-logo-link' rel='home' itemprop='url'><img width='250' height='250' src='./images/cropped-universoMini_logo3.png' class='custom-logo' alt='' itemprop='logo' srcset='./images/cropped-universoMini_logo3.png 250w, ./images/cropped-universoMini_logo3-150x150.png 150w, ./images/cropped-universoMini_logo3-100x100.png 100w' sizes='100vw'></a><br>
© 2018 Periodic Space<br>
<br>
<span style='font-size:8px'>Todos los derechos reservados.</span></p>
</footer>
</div>
</div>
</div>
</div>
<div id='pentagramSlider-container'>
<div style='position:absolute;margin:10px 0 0 5rem'>
<label for='sliderOctave'>Octave:</label><output for='sliderOctave' id='sliderOctaveValue'>3</output>
<input type='range' id='sliderOctave' name='sliderOctave' min='2' max='5' step='1' value='3' onchange='cambiarOctave()'>
<button id='drag-boton' class='activo'>Haz clic aquí</button>
</div>
<div style='position:absolute;margin:10px 0 0 5rem;right:70px'>
<label for='slider'>Freds:</label><output for='slider' id='sliderValue'>24</output>
<input type='range' id='slider' name='slider' min='8' max='24' step='2' value='24' onchange='cambiarnumFrets()'>
</div>
</div>
<div id='guitar-neck'>
</div>
<div>
<div id='tonic-container'>
</div>
<div id='select-acorde' onchange='cambiarAcorde()' style='display:block;text-align:center'>
</div>
<div id='botonera' style='display:block;text-align:center'></div>
</div>
<div id='contenedor'></div>
<div id='modes-container'>
</div>
<div id='circuloQuintas' style='text-align:center'></div>
<div id='alphatab' style='text-align:center'>
	<a href="https://parencode.github.io/guitar/alphaTab-color/">AlphaTab Colored</a>
</div>

<div id='alphatab' style='text-align:center'>
<a href="https://parencode.github.io/guitar/">La guitarra</a>

</div>

<footer style='text-align:center'>
<p>&copy; 2023 <a href='https://periodicspace.com/'>Periodic Space</a><br><span style='font-size:8px'>Todos los derechos reservados.</span></p>
</footer>
<script>d3.selectAll("div").style("opacity",0),window.onload=function(){d3.selectAll("div").transition().duration(1500).style("opacity",1)};const copyright="pabloAlbiR-periodicspace.com",infoButton=d3.select(".info-button"),infoPopup=d3.select(".info-popup");infoButton.on("click",()=>{infoPopup.style("display","block")}),d3.select(".popup-content").on("click",function(e){e.stopPropagation()});var closeButton=d3.selectAll(".popup, .close-btn");closeButton.on("click",function(){infoPopup.style("display","none")});const customSymbol=()=>{var e=d3.path();return e.arc(5,0,5,0,2*Math.PI),e.moveTo(-1,0),e.arc(-5,0,5,0,2*Math.PI),e.closePath(),e.toString()},customSymbolHexagon=()=>{var t=d3.path();t.moveTo(0,-8);for(let e=0;e<6;e++){var a=2*Math.PI*e/6,n=8*Math.sin(a),a=-8*Math.cos(a);t.lineTo(n,a)}return t.closePath(),t.toString()},customSymbolStar7=()=>{var t=d3.path();t.moveTo(0,-10);for(let e=0;e<14;e++){var a=2*Math.PI*e/14,n=e%2==0?8:4,r=n*Math.sin(a),n=-n*Math.cos(a);t.lineTo(r,n)}return t.closePath(),t.toString()},symbolGenerator=e=>{switch(e){case 0:return d3.symbol().type(d3.symbolCircle).size(100);case 1:return customSymbol();case 2:return d3.symbol().type(d3.symbolTriangle).size(100);case 3:return d3.symbol().type(d3.symbolSquare).size(100);case 4:return d3.symbol().type(d3.symbolStar).size(100);case 5:return customSymbolHexagon();case 6:return customSymbolStar7();default:return null}};let synth,polySynth;function handleClick(e){synth=new Tone.Synth({oscillator:{type:"custom",partials:[1,0,2,0,3]}}).toDestination();var t=new Tone.Filter({type:"bandpass",frequency:0,Q:0,gain:0}).toDestination(),a=(synth.connect(t),new Tone.EQ3(-20,-10,5).connect(t)),n=new Tone.AmplitudeEnvelope({attack:.001,decay:1.2,sustain:0,release:1.2}).connect(a),a=new Tone.Reverb({decay:1.5,wet:.2}).connect(a),n=(synth.chain(n,a),synth.volume.value=0,new Tone.Vibrato({frequency:15,depth:.04,type:"sine"}).connect(t));synth.connect(n),polySynth=new Tone.PolySynth({options:{envelope:{attack:2,decay:1,sustain:.2,release:2}}}).toDestination(),document.body.removeEventListener("click",handleClick)}function sonarNota(e,t){void 0!==e&&void 0!==t&&synth.triggerAttackRelease(""+e+t,"8n")}function sonarAcorde(e){polySynth.triggerAttackRelease(e,"4n")}function getFrequency(e,t){return{E2:82.41,A4:110,A3:146.83,G3:196,B3:246.94,E4:329.63}[e+t]}document.body.addEventListener("click",handleClick);const margin={top:40,right:20,bottom:20,left:0};let fretWidth=0,stringHeight=0;function drawGuitarNeck(e,t,a,n,r,o,s,l){var e=d3.select(e),i=e.node().clientWidth-margin.left-margin.right;const c=e.node().clientHeight-margin.top-margin.bottom,d=8==t?-6:-1;t=8==t?12:t,fretWidth=i/t,stringHeight=c/a;a=e.append("svg").attr("viewBox",`0 0 ${i+margin.left+margin.right} `+(c+margin.top+margin.bottom)).attr("width",i+margin.left+margin.right).attr("height",c+margin.top+margin.bottom).append("g").attr("id","fretboard").attr("transform",`translate(${i/24},${margin.top})`);var e=getScales([0,1,2,3,4,5,6,7,8,9,10,11],"C"),u=a.append("g");for(let e=0;e<t;e++){var p=e*fretWidth;u.append("rect").attr("x",p).attr("y",0).attr("width",fretWidth).attr("height",c).style("stroke","none").style("stroke-width","1px").style("fill","none")}i=a.append("g").attr("id","noteGroupColor").style("fill","grey");const g=["#000","#E6E6E6","#717175","#E6E6E6","#000"];i.selectAll("g").data(e).enter().append("rect").attr("class","noteGroupColorNote").attr("x",e=>(e.fret+d)*fretWidth).attr("y",e=>e.string*stringHeight-stringHeight).attr("width",fretWidth).attr("height",c/6).style("fill",e=>assignColor(e.note)).style("stroke",e=>g[e.octave-2]).style("paint-order","stroke").style("stroke-width",e=>"5px").style("stroke-linecap","round").style("stroke-position","inside").style("stroke-dasharray","1, 0").order((e,t)=>t).attr("data-Note",e=>""+e.note+e.octave).append("title").text(e=>e.note+"  "+e.octave),i.selectAll(".noteGroupColorNote").on("click",function(e){sonarNota(d3.select(this).datum().note,d3.select(this).datum().octave),pentagramSecuence(d3.select(this).datum().note,d3.select(this).datum().octave,"C","C")});var m=a.append("g");for(let e=0;e<1;e++){var h=(e-1)*fretWidth;m.append("rect").attr("x",h).attr("y",0).attr("width",fretWidth).attr("height",c).style("fill","none").style("stroke","black").style("stroke-width","7px")}const v=a.append("g").style("z-index",10);[3,5,7,9,12,15,17,19,21].forEach(e=>{var t=(e-1)*fretWidth+fretWidth/2;let a=c/2;12==e&&(a-=stringHeight),v.append("circle").attr("cx",t).attr("cy",a).attr("r",o).style("fill","black").style("stroke","black").style("stroke-width","1px"),12==e&&v.append("circle").attr("cx",t).attr("cy",a+2*stringHeight).attr("r",o).style("fill","black").style("stroke","black").style("stroke-width","1px")})}const greyColors=["#000","#717175","#ADADB2","#ffffff","#000"];function drawScaleWithMovableRect(e,t,a,n,r,o){var s=d3.select(t);const l=40,i=20,c=20,d=0;var u=s.node().clientWidth-d-i,s=s.node().clientHeight-l-c,p=d3.select(t+" svg g");5==octaveIN&&d3.selectAll(".noteGroupColorNote").nodes().forEach(e=>{var t=getComputedStyle(e).fill,a=getComputedStyle(e).stroke;d3.select(e).style("fill",a),d3.select(e).style("stroke",t)});const g=8==r?-6:-1,m=u/(r=8==r?12:r),h=s/o;var v=getScales(a,n);for(let e=0;e<v.length;e++)v[e].pos={x:m/2,y:0};d3.scaleLinear().domain([1,5]).range([.5,.9]);const f=p.append("g").attr("id","noteGroup").style("pointer-events","none");return f.selectAll("g").data(v).enter().append("circle").attr("class","notesScaless").attr("cx",e=>(e.fret+g-(4<tonicIndex?12:0))*m+m/2).attr("cy",e=>e.string*h-h/2).attr("r",10).each(function(e,t){var a=(e.fret+g-(4<tonicIndex?12:0))*m+m/2,n=e.string*h-h/2,r=e.degree,r=symbolGenerator(r);f.append("path").data([e]).attr("d",r).attr("class","degreePath").attr("transform",`translate(${a},${n})`).style("pointer-events","none").style("fill",greyColors[e.octave-2]).style("stroke","#fff").style("stroke-width","3px")}).on("click",function(e){e.preventDefault()}).call(d3.drag().on("start",function(){event.preventDefault(),d3.select(this).style("cursor","grabbing")}).on("drag",function(e){e=e.x,e=Math.max(0,Math.min(e,24*m));const t=Math.round(e/m)+1-d3.select(this).datum().fret;0!=t&&setNote(t),f.selectAll("circle").attr("cx",e=>(e.fret+=t,e.fret*m-m/2)),f.selectAll(".degreePath").attr("transform",e=>{return`translate(${(e.fret-1)*m+m/2},${e.string*h-h/2})`})}).on("end",function(){d3.select(this).style("cursor","grab"),d3.selectAll(".notesScaless").style("pointer-events","auto")})).style("fill","#ffffff00").style("stroke","#666666").style("stroke",(e,t)=>greyColors[e.octave-2]).style("stroke-width","2px"),p.append("g").append("text").attr("id","titulo").attr("x",u/2).attr("y",-10).text(e).style("font-size","20px").style("text-anchor","middle").on("click",function(e){a=[],scalesName="",d3.select("#noteGroup").remove(),d3.select("#titulo").remove(),drawScaleWithMovableRect(scalesName,t,a,n,r,o),escalaMayor(a,n)}),{scaleNotes:v}}const notes=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],newNotes=["A","A#","B","C","C#","D","D#","E","F","F#","G","G#"];let tonicIndex;function getScales(o,e){tonicIndex=notes.indexOf(e);let t=[];var a={1:["E1","F1","F#1","G1","G#1","A1","A#1","B1","C2","C#2","D2","D#2"],2:["B1","C2","C#2","D2","D#2","E2","F2","F#2","G2","G#2","A2","A#2"],3:["G2","G#2","A2","A#2","B2","C3","C#3","D3","D#3","E3","F3","F#3"],4:["D3","D#3","E3","F3","F#3","G3","G#3","A3","A#3","B3","C4","C#4"],5:["A3","A#3","B3","C4","C#4","D4","D#4","E4","F4","F#4","G4","G#4"],6:["E4","F4","F#4","G4","G#4","A4","A#4","B4","C5","C#5","D5","D#5"]};const s=[-4,-11,-7,-2,-9,-4],l=[4,3,3,3,2,2];for(let r=1;r<=6;r++){r;var n=o.map((e,t)=>{(o.length<7||7<o.length)&&0<e&&(t=-1);var a=(tonicIndex+e)%12,n=l[r-1];return{note:notes[a],fret:e+s[r-1]+tonicIndex,string:r,degree:t,octave:n}});t=t.concat(n).concat(n.map(e=>{return{note:e.note,fret:e.fret+12,string:e.string,degree:e.degree,octave:e.octave+1}})).concat(n.map(e=>{return{note:e.note,fret:e.fret+12+12,string:e.string,degree:e.degree,octave:e.octave+2}}))}return t}let numFrets=24;const numStrings=6,containerId=(drawGuitarNeck("#guitar-neck",numFrets,numStrings,2,30,6,"#eee","#333"),"#guitar-neck"),container=d3.select(containerId);let scalesName="Ionian C",scaleName="Pentatonic Minor",scaleIntervals=[0,2,4,5,7,9,11],tonicNote="C";const majorIntervals=[0,2,4,5,7,9,11],naturalMinorIntervals=[0,2,3,5,7,8,10],harmonicMinorIntervals=[0,2,3,5,7,8,11],melodicMinorIntervals=[0,2,3,5,7,9,11],majorPentatonicIntervals=[0,2,4,7,9],minorPentatonicIntervals=[0,3,5,7,10],bluesIntervals=[0,3,5,6,7,10],dorianIntervals=[0,2,3,5,7,9,10],phrygianIntervals=[0,1,3,5,7,8,10],lydianIntervals=[0,2,4,6,7,9,11],mixolydianIntervals=[0,2,4,5,7,9,10],locrianIntervals=[0,1,3,5,6,8,10];let scalesId=0;const scales=[{nombre:"Jónico/Mayor C",intervalos:[0,2,4,5,7,9,11]},{nombre:"Dórica D",intervalos:[0,2,3,5,7,9,10]},{nombre:"Frigia E",intervalos:[0,1,3,5,7,8,10]},{nombre:"Lidia F",intervalos:[0,2,4,6,7,9,11]},{nombre:"Mixolidia G",intervalos:[0,2,4,5,7,9,10]},{nombre:"Eólico/Menor Natural A",intervalos:[0,2,3,5,7,8,10]},{nombre:"Locria B",intervalos:[0,1,3,5,6,8,10]},{nombre:"Menor Armónica",intervalos:[0,2,3,5,7,8,11]},{nombre:"Menor Melódica",intervalos:[0,2,3,5,7,9,11]},{nombre:"Pentatónica Mayor",intervalos:[0,2,4,-100,7,9]},{nombre:"Pentatónica Menor",intervalos:[0,-100,3,5,7,-100,10]},{nombre:"Blues",intervalos:[0,3,5,6,7,10]},{nombre:"Blues Mayor",intervalos:[0,3,4,5,6,7,10]},{nombre:"Blues Menor",intervalos:[0,3,5,6,7,10]},{nombre:"Hirajoshi",intervalos:[0,2,3,7,8]},{nombre:"Hijaz",intervalos:[0,1,4,5,7,8,11]},{nombre:"Kafi",intervalos:[0,1,3,6,7,8,11]},{nombre:"Mixta de Blues",intervalos:[0,2,3,4,7,9,10]},{nombre:"Pentatónica Mayor de Raga Shivaranjani",intervalos:[0,1,3,5,7,8,10]},{nombre:"Romani",intervalos:[0,2,3,6,7,8,10]},{nombre:"Tzigane",intervalos:[0,2,3,6,7,8,11]},{nombre:"Bebop Mayor",intervalos:[0,2,4,5,7,8,9,11]},{nombre:"Bebop Menor",intervalos:[0,2,3,5,7,9,10,11]},{nombre:"Pentatónica Menor de Raga Bhairav",intervalos:[0,-100,3,5,7,-100,10]},{nombre:"Escala China",intervalos:[0,2,4,7,9]},{nombre:"Escala Húngara Mayor",intervalos:[0,3,4,6,7,9,10]},{nombre:"Escala Húngara Menor",intervalos:[0,2,3,6,7,8,11]},{nombre:"Escala Japonesa de Pelog",intervalos:[0,1,5,7,8]},{nombre:"Escala Japonesa de Sakura",intervalos:[0,4,6,7,11]},{nombre:"Escala de Septimoinferior",intervalos:[0,1,3,4,6,8,10]},{nombre:"Escala de Bebop Dominante",intervalos:[0,2,4,5,7,9,10,11]},{nombre:"Escala de Bebop Mayor",intervalos:[0,2,4,5,7,8,9,11]},{nombre:"Escala de Bebop Menor",intervalos:[0,2,3,5,7,8,9,10,11]},{nombre:"Ejercicio Mayor",intervalos:[0,-100,4,-100,7,-100,-100]},{nombre:"Ejercicio Menor",intervalos:[0,-100,3,-100,7,-100,-100]}],escalasContainer=d3.select("#escalas-container");function setNote(e){e=notes.indexOf(tonicNote)+e;tonicIndex=-1==e?11:12==e?0:e,tonicNote=notes[tonicIndex],buttons.filter(function(e){return e===notes[tonicIndex]}).each(function(e){buttons.style("color","#000"),d3.select(this).style("color","#fff")})}function cambiarnumFrets(){d3.select("#guitar-neck").select("*").remove(),d3.select("#noteGroup").remove(),d3.select("#titulo").remove(),document.getElementById("sliderValue").value=document.getElementById("slider").value,drawGuitarNeck("#guitar-neck",numFrets=document.getElementById("slider").value,numStrings,2,30,6,"#eee","#333"),drawScaleWithMovableRect(scales[scalesId].nombre,containerId,scales[scalesId].intervalos,tonicNote,numFrets,numStrings),createSecuence(sequenceFullNotes[0])}let octaveIN=3;function cambiarOctave(){document.getElementById("sliderOctaveValue").value=document.getElementById("sliderOctave").value,octaveIN=document.getElementById("sliderOctave").value,cambiarScale()}function cambiarScale(){d3.select("#noteGroup").remove(),d3.select("#titulo").remove(),escalaMayor(scaleIntervals,tonicNote),drawScaleWithMovableRect(scalesName,containerId,scaleIntervals,tonicNote,numFrets,numStrings),createSecuence(sequenceFullNotes[0])}function cambiarTonic(){tonicNote=document.getElementById("select-tonic").value}const buttonContainer=d3.select("#tonic-container").attr("style","text-align:center"),buttons=buttonContainer.selectAll("button").data(notes).enter().append("button").attr("class","ios-btn").style("background-color",e=>assignColor(e)).text(e=>e).on("click",function(e,t){buttons.style("color","#fff").style("stroke","none").style("font-size","16px"),d3.select(this).style("color","pink").style("font-size","18px"),visualizarAcordes([]),(tonicNote=t).replace("#","sharp"),d3.selectAll(".hidden").style("display","none"),d3.selectAll("#botonera").style("display","none"),d3.select("#selectN"+tonicNote.replace("#","sharp")).style("display","inline-block"),d3.select("#selectChord"+tonicNote.replace("D#","Eb").replace("G#","Ab").replace("A#","Bb").replace("#","sharp")+"major").dispatch("click")}),{scaleNotes,movableRect}=(buttons.filter(function(e){return e===notes[0]}).each(function(e){d3.select(this).style("color","pink")}),drawScaleWithMovableRect(scalesName,containerId,scales[0].intervalos,tonicNote,numFrets,numStrings)),crearBotonesEscalas=()=>{const t=escalasContainer.selectAll("button").data(scales).enter().append("button").attr("data",(e,t)=>""+t).text(e=>e.nombre).on("click",function(e){t.style("color","#000"),d3.select(this).style("color","red"),scalesId=parseInt(this.getAttribute("data")),cambiarScale()});t.filter(":first-child").each(function(e){d3.select(this).style("color","#ffff")})};function obtenerScaleSeleccionado(){var e=document.getElementById("select-scale"),e=e.options[e.selectedIndex].value;return scales[e]}function renderizarColumnas(e){var t=d3.select("#contenedor");t.selectAll(".columna").remove(),600<e?(t.append("div").classed("columna1",!0).style("width","50%").style("display","inline-block").style("position","relative"),t.append("div").classed("columna2",!0).style("width","50%").style("display","inline-block")):t.append("div").classed("columna",!0).style("width","100%").text("Columna única")}function textWrap(e,t){var a=e.split(/\s+/),n=[];let r="";for(let e=0;e<a.length;e++){var o=a[e];r.length+o.length>t&&(n.push(r.trim()),r=""),r+=o+" "}return n.push(r.trim()),n}function setScales(){d3.json("./data/Scales.json").then(o=>{var e=d3.group(o.presets,e=>e.Group);const t=d3.scaleOrdinal(d3.schemeCategory10);var a=heigthPentagram/2,n=d3.select("#contenedor .columna2");const r=1400/e.size;n=n.selectAll("svg").data([...e]).join("div").attr("style",` height: ${a}px; overflow-x: auto; text-align:center;display:inline-block`).style("width",r).append("svg").attr("class","columnSvg").attr("width",r).attr("height",4e3).attr("style","overflow-x: auto;").append("g").attr("id",e=>"column-"+e[0]).attr("transform",(e,t)=>`translate(${0*r}, 0)`);n.append("rect").attr("x",0).attr("y",0).attr("width",r).attr("height",4e3).attr("fill",e=>t(e[0])),n.append("text").text(e=>e[0]).attr("x",r/2).attr("y",20).attr("text-anchor","middle").attr("fill","white"),n.each(function(t){var e=d3.select(this),a=o.presets.filter(e=>e.Group===t[0]);a.length;const n=e.selectAll("g").data(a).enter().append("g").attr("id",e=>e.Name.replace(/[^a-zA-Z0-9]/g,"_")).attr("class",e=>e.Group).on("click",(e,t)=>{n.style("color","#fff"),d3.selectAll(".columnSvg text tspan").attr("fill","#fff"),d3.select("#"+t.Name.replace(/[^a-zA-Z0-9]/g,"_")).selectAll("tspan").attr("fill","black"),d3.select("#noteGroup").remove(),d3.select("#titulo").remove(),visualizarAcordes([]),scaleIntervals=t.Value.split(";").map(Number).map(e=>e-1),scalesName=t.Name,drawScaleWithMovableRect(t.Name,containerId,scaleIntervals,tonicNote,numFrets,numStrings),escalaMayor(scaleIntervals,tonicNote)});let r=20;n.append("text").attr("x",5).attr("y",(e,t)=>{var a=r,e=20*textWrap(e.Name,18).length;return r+=10+e,a}).selectAll("tspan").data(e=>textWrap(e.Name,18)).join("tspan").attr("x",5).attr("dy","1.2em").text(e=>e).attr("fill","white"),n.select("#Major tspan").attr("fill","black"),d3.select(e.node().parentNode).style("height",r+40+"px"),e.selectAll("rect").attr("height",r+40)}),d3.select(".columna1").style("height",d3.select(".columna2").node().offsetHeight+40+"px")})}renderizarColumnas(window.innerWidth),setScales();const numRec=22,notes0=["E","F","G","A","B","C","D"],notesPentagrama=["E","D","C","B","A","G","F"];let heigthPentagram=400,widthPentagram=window.innerWidth/2-50;const numLineas=5,alturaLineas=widthPentagram/100,anchoLinea=window.innerWidth/2-50,espacioEntreLineas=alturaLineas,x=5*alturaLineas;let y=5*alturaLineas;heigthPentagram+=x;const numColumnas=1,alturaRec=alturaLineas+espacioEntreLineas,anchoRec=20;let isSharp="";const svg=d3.select("#contenedor .columna1").append("div").style("position","absolute").append("svg").attr("width",widthPentagram).attr("height",heigthPentagram).on("mousedown",function(){var t=d3.pointer(event);d3.select(window).on("mousemove",function(){var e=d3.pointer(event)[0]-t[0];0<e?isSharp="#":e<0&&(isSharp="")})}).on("mouseup",function(){d3.select(window).on("mousemove",null)}).on("click",agregarNota);function escalar(e){var t=window.innerWidth,a=window.innerHeight,t=Math.min(t/e.attr("width"),a/e.attr("height"))/2;e.attr("transform",`scale(${t})`)}window.addEventListener("resize",escalar);const gruposRec=svg.selectAll(".rec").data(d3.range(numRec)).enter().append("g").attr("class","rec").attr("transform",(e,t)=>`translate(${x-20}, ${y+t*alturaRec})`),textos=(gruposRec.append("rect").attr("class","rectangulo").attr("x",0).attr("y",0).attr("width",anchoRec).attr("height",alturaRec).style("fill",(e,t)=>assignColor(notesPentagrama[t%notesPentagrama.length])).on("click",function(e,t){e.stopPropagation()}),gruposRec.append("text").attr("x",anchoRec/2).attr("y",alturaRec/2).attr("text-anchor","middle").style("font-size","16px").style("fill","#fff").style("dominant-baseline","central").text((e,t)=>notesPentagrama[t%notesPentagrama.length]).on("click",function(e,t){e.stopPropagation()})),gruposLineas=svg.selectAll(".linea").data(d3.range(numLineas)).enter().append("g").attr("class","linea").attr("transform",(e,t)=>`translate(${x}, ${6*alturaRec+y+t*(2*alturaRec)})`);function agregarNota(){var e=d3.pointer(event);const t=Math.round((e[1]-3-y)/alturaRec);var e=x+Math.round((e[0]-x)/alturaRec)*alturaRec,a=y+t*alturaRec+alturaRec/2;sonarNota(notesPentagrama[t%notesPentagrama.length]+isSharp,t%22<=2?5:t%22<=9?4:t%22<=16?3:2);const n=svg.append("circle").attr("class","notaAgregada").attr("cx",e).attr("cy",a).attr("r",2*alturaLineas).attr("data-note",notesPentagrama[t%notesPentagrama.length]+isSharp).style("fill",assignColor(notesPentagrama[t%notesPentagrama.length]+isSharp)).on("mousedown",function(){event.stopPropagation();var t=d3.pointer(event);d3.select(window).on("mousemove",function(){event.stopPropagation();var e=d3.pointer(event)[0]-t[0];(0<e||e<0)&&n.remove()})}).on("mouseup",function(){d3.select(window).on("mousemove",null),event.stopPropagation()}).on("click",()=>{event.stopPropagation(),sonarNota(n.attr("data-note"),t%22<=2?5:t%22<=9?4:t%22<=16?3:2)})}function escalaMayor(n,e="C"){var r=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],o=[0,0,2,2,4,6,6,8,8,10,10,12].map(e=>e*alturaRec/2),s=alturaRec*(21-7*(octaveIN-2))+x,l=r.indexOf(e),i=(d3.selectAll(".notaAgregada").remove(),o[l%12],[]);for(let a=0;a<n.length;a++){var c=r[(n[a]+l)%12];let e=s-o[r.indexOf(c)%12],t=(r.indexOf(c)<l&&(e+=7*-alturaRec),e,octaveIN);r.indexOf(c)<l&&t++;var d=a;i.push({nota:c,altura:e,posicion:d+7*a,octava:t})}return svg.select("#pentagramaNotes").remove(),svg.append("g").attr("id","pentagramaNotes").selectAll("circle").data(i).enter().append("circle").attr("cx",e=>e.posicion*alturaLineas+3*x).attr("cy",e=>e.altura+x).attr("r",2*alturaLineas).style("fill",(e,t)=>assignColor(e.nota)).on("click",function(e,t){e.stopPropagation(),sonarNota(t.nota,t.octava)}),i}gruposLineas.selectAll(".pentagrama").data([null]).enter().append("line").attr("class","pentagrama").attr("x1",0).attr("y1",alturaLineas).attr("x2",anchoLinea).attr("y2",alturaLineas).style("dominant-baseline","central"),escalaMayor(scales[0].intervalos,tonicNote,tonicNote);var acordes2=[{nombre:"C",notas:[0,1,0,2,3,0],digitacion:["0","1","0","2","3","X"]},{nombre:"Cm",notas:[3,4,5,5,3,3],digitacion:["1","2","5","4","1","1"]},{nombre:"C7",notas:[0,1,3,2,3,-1],digitacion:["O","1","4","2","3","X"]},{nombre:"Cm7",notas:[3,5,3,5,3,3],digitacion:["3","5","3","5","3","3"]},{nombre:"C5",notas:[3,-1,5,5,-1,3],digitacion:["X","X","5","5","X","3"]},{nombre:"Cdim",notas:[3,4,5,3,5,-1],digitacion:["3","4","5","3","5","X"]},{nombre:"Cmaj7",notas:[0,0,0,2,3,0],digitacion:["0","0","0","2","3","X"]},{nombre:"Cm6",notas:[3,4,5,5,5,3],digitacion:["3","4","5","5","5","3"]},{nombre:"Cadd9",notas:[-1,3,2,0,3,-1],digitacion:["X","3","2","0","3","X"]},{nombre:"Caug",notas:[0,1,2,3,-1,-1],digitacion:["X","1","2","3","X","X"]}];let chordsJs;const selectContainer=d3.select("#select-acorde");function botonAcordes(e){var t=d3.select("#botonera");t.style("display","block");var a=t.selectAll("button").data(e.positions).enter().append("button").attr("class","botonChordSelect").style("margin","5px").style("padding","10px").style("background-color","#ccc").style("border","none").style("border-radius","5px").style("color","#fff");a.text(function(e,t){return t+1}),a.on("click",function(e,t){t.frets.slice().reverse(),t.fingers.slice().reverse(),visualizarAcordes([t]),a.style("color","#fff"),d3.select(this).style("color","black")})}function cambiarAcorde(){}function visualizarAcordes(e){var t=d3.select("#drag-boton").classed("activo"),t=(0<e.length&&!t&&sonarAcorde(e[0].midi.map(e=>new Tone.Frequency(e,"midi").toFrequency())),d3.select("#fretboard"));d3.scaleBand().domain(["E","F","F#","G","G#","A","A#","B","C","C#","D","D#"]).range([0,360]),d3.scaleLinear().domain([0,4]).range([80,320]),t.selectAll(".circulo").data(e).join("g").attr("class","circulo").selectAll("circle").data(function(n){return n.frets.map(function(e,t){var a=n.frets.length-t-1;return{nota:e,notas:n.frets[a]+n.baseFret-1,cuerda:t,digitacion:n.fingers}})}).join("circle").attr("cx",function(e){return(parseInt(e.notas)||0)*fretWidth-fretWidth/2}).attr("cy",function(e){return parseInt(e.cuerda)*stringHeight+stringHeight/2}).attr("r",12).style("fill","white").style("stroke","black").style("pointer-events","none"),t.selectAll(".digitacion").data(e).join("g").attr("class","digitacion").selectAll("text").data(function(n){return n.fingers.map(function(e,t){var a=n.fingers.length-t-1;return{nota:e,notas:n.frets[t]+n.baseFret-1,cuerda:a,digitacion:n.fingers}})}).join("text").attr("x",function(e){return fretWidth,(parseInt(e.notas)||0)*fretWidth-fretWidth/2}).attr("y",function(e){return parseInt(e.cuerda)*stringHeight+stringHeight/2+5}).attr("text-anchor","middle").text(function(e,t){return e.digitacion[t]}).style("pointer-events","none")}d3.json("./data/guitar.json").then(function(a){chordsJs=a.chords;Object.values(a.chords);var e=selectContainer.selectAll("svg").data([...a.keys]).join("div").attr("id",e=>"selectN"+e.replace("Eb","D#").replace("Ab","G#").replace("Bb","A#").replace("#","sharp")).attr("class","hidden").attr("style"," height: 90px; overflow-x: auto; text-align:center;").style("width",700).append("svg").attr("width",700).attr("height",280).attr("style","overflow-y: auto;").append("g").attr("id",e=>"column-"+e.replace("Eb","D#").replace("Ab","G#").replace("Bb","A#").replace("#","sharp")).attr("transform",(e,t)=>"translate(0, 0)");e.append("rect").attr("x",-5).attr("y",0).attr("width",710).attr("height",e=>300*e.length).attr("fill","none").attr("stroke",e=>assignColor(e.replace("Eb","D#").replace("Ab","G#").replace("Bb","A#"))).attr("stroke-width",10).attr("stroke-linejoin","round"),e.each(function(e){var t=d3.select(this),e=Object.values(a.chords[e.replace("#","sharp")]),e=(e.length,t.selectAll("g").data(e).enter().append("g").attr("id",e=>"selectChord"+e.key.replace("#","sharp")+e.suffix.replace("#","sharp").replace("/","_")).attr("class","acore").attr("transform",(e,t)=>`translate(${t%7==0?0:t%7*100},${10*Math.floor(t/7)})`).on("click",(e,t)=>{d3.selectAll(".acore text tspan").attr("fill","#000").attr("stroke","none"),d3.select("#selectChord"+t.key.replace("#","sharp")+t.suffix.replace("#","sharp").replace("/","_")).select("tspan").attr("fill",assignColor(t.key)).attr("stroke",assignColor(t.key)),botonAcordes(t),d3.select(".botonChordSelect").dispatch("click")}));let n=0;let r=0;e.append("text").attr("x",(e,t)=>{}).attr("y",(e,t)=>{var a=n;return(t+1)%7==0&&(textWrap(e.suffix,18),r+=20,n+=20),a}).selectAll("tspan").data(e=>textWrap(e.suffix,18)).join("tspan").attr("x",5).attr("dy","1.2em").text(e=>e).attr("fill","black"),d3.select(t.node().parentNode).style("height",n+100+"px")}),d3.select("#tonic-container .ios-btn").dispatch("click"),d3.select("#selectChordCmajor").dispatch("click"),d3.select(".botonChordSelect").dispatch("click")});const circuloQuintas=d3.select("#circuloQuintas").append("svg");function assignColor(e){switch(e){case"C":return"#001C7D";case"Db / C#":return"#A4C2FF";case"D":return"#00BFFF";case"Eb":return"#8FD7C1";case"E":return"#3DAB60";case"F":return"#9CDC4D";case"Gb / F#":return"#D8DFA1";case"G":return"#F0E500";case"Ab":return"#FFB96F";case"A":return"#F40009";case"Bb":return"#C97AFF";case"Cb / B":return"#7B3F9D";case"c":return"#001C7D";case"c#":return"#A4C2FF";case"d":return"#00BFFF";case"eb / d#":return"#8FD7C1";case"e":return"#3DAB60";case"f":return"#9CDC4D";case"f#":return"#D8DFA1";case"g":return"#F0E500";case"ab / g#":return"#FFB96F";case"a":return"#F40009";case"bb / a#":return"#C97AFF";case"b":return"#7B3F9D";case"Cdim":return"#001C7D";case"C#":return"#A4C2FF";case"Ddim":return"#00BFFF";case"D#":return"#8FD7C1";case"E":return"#3DAB60";case"E#":return"#9CDC4D";case"F#":return"#D8DFA1";case"Gdim":return"#F0E500";case"G#":return"#FFB96F";case"Adim":return"#F40009";case"A#":return"#C97AFF";case"B":return"#7B3F9D";case"B#":return"#001C7D";default:return"grey"}}function createQuintCircle(e,n,r,t,a,o){var s=d3.pie().startAngle(-Math.PI/12).endAngle(2*Math.PI-Math.PI/12).value(1),l=d3.arc().innerRadius(t-50).outerRadius(t),i=circuloQuintas.attr("width",n).attr("height",r).append("g").attr("class","group").attr("transform",`translate(${n/2}, ${r/2})`),s=i.selectAll(".arc").data(s(e)).join("g").attr("class","arc");s.append("path").attr("d",l).style("fill",e=>assignColor(e.data.name)).style("stroke","#ccc").style("stroke-width","2px"),s.append("text").attr("class","quitas").attr("transform",function(e){return e.innerRadius=t-50,e.outerRadius=t,e.angle=(e.startAngle+e.endAngle)/2,`rotate(${180*e.angle/Math.PI-90})translate(${e.outerRadius-(e.outerRadius-e.innerRadius)/2})`}).style("writing-mode","tb-rl").style("text-align","center").attr("text-anchor","middle").style("fill","#FFFFFF").style("stroke","#FFF").style("font-size","24px").text(e=>e.data.name);let c=0;let d=0;return s.on("click",(e,t)=>{d=0;e.x;d-=30*Math.round(t.data.angle/30),d3.selectAll(".group").transition().attr("transform",`translate(${n/2}, ${r/2}) rotate(${d})`).duration(1e3)}),i.call(d3.drag().on("start",function(){setRelatives(tipeRelatives=-1==o?tipeRelatives:o)}).on("drag",(e,t)=>{var a=e.dx,e=e.dy;Math.abs(a)>Math.abs(e)&&25<=++c&&(e=0<a?1:-1,d+=30*e,d3.selectAll(".group").transition().attr("transform",`translate(${n/2}, ${r/2}) rotate(${d})`).duration(200),c=0)})),i}const dataMayores=[{name:"C",angle:0},{name:"G",angle:30},{name:"D",angle:60},{name:"A",angle:90},{name:"E",angle:120},{name:"Cb / B",angle:150},{name:"Gb / F#",angle:180},{name:"Db / C#",angle:210},{name:"Ab",angle:240},{name:"Eb",angle:270},{name:"Bb",angle:300},{name:"F",angle:330}],dataMenores=[{name:"a",angle:0},{name:"e",angle:30},{name:"b",angle:60},{name:"f#",angle:90},{name:"c#",angle:120},{name:"ab / g#",angle:150},{name:"eb / d#",angle:180},{name:"bb / a#",angle:210},{name:"f",angle:240},{name:"c",angle:270},{name:"g",angle:300},{name:"d",angle:330}],dataDisminuidas=[{name:"B",angle:0},{name:"F#",angle:30},{name:"C#",angle:60},{name:"G#",angle:90},{name:"D#",angle:120},{name:"A#",angle:150},{name:"E#",angle:180},{name:"C",angle:210},{name:"G",angle:240},{name:"D",angle:270},{name:"A",angle:300},{name:"E",angle:330}],dataDisminuidasText=[{name:"",angle:0}],width=500,height=500,radius=200;let tipeRelatives=0;const circleMayores=createQuintCircle(dataMayores,width,height,radius,"#e41a1c",0),circleMenores=createQuintCircle(dataMenores,width,height,radius-50,"#377eb8",1),circleDisminuidas=createQuintCircle(dataDisminuidas,width,height,radius-100,"#377eb8",-1),circleDisminuidasText=createQuintCircle(dataDisminuidasText,width,height,radius-150,"none",-1),dataRelitivesMenor3=[-1,-1,5,-1,-1,2,-1,-1,6],dataRelitivesMenor2=[-1,-1,3,-1,-1,0,-1,-1,4],dataRelitivesMenor1=[-1,-1,-1,-1,-1,1,-1,-1,-1],dataRelitivesMayor3=[-1,-1,3,-1,-1,0,-1,-1,4],dataRelitivesMayor2=[-1,-1,1,-1,-1,5,-1,-1,2],dataRelitivesMayor1=[-1,-1,-1,-1,-1,6,-1,-1,-1];function createRelatives(e,t){var a=d3.pie().startAngle(-Math.PI/12*3).endAngle(Math.PI/12*3).value(1);const n=d3.arc().innerRadius(t-25).outerRadius(t),r=circuloQuintas.append("g").attr("class","relatives").attr("transform",`translate(${width/2}, ${height/2})`).selectAll(".arc").data(a(e)).join("g").attr("class","arc");r.append("path").attr("d",n).each(function(e,t){var a=symbolGenerator(e.data);r.append("g").append("path").data([e]).attr("d",a).attr("class","degreePath").attr("transform",e=>`translate(${n.centroid(e)})`).style("fill","#000").style("stroke","#fff").style("stroke-width","3px").style("pointer-events","none")}).style("fill","none").style("stroke","none").style("stroke-width","2px")}function setRelatives(e){d3.selectAll(".relatives").transition().duration(10).remove(),0==e?(createRelatives(dataRelitivesMayor3,radius),createRelatives(dataRelitivesMayor2,radius-50),createRelatives(dataRelitivesMayor1,radius-100)):1==e&&(createRelatives(dataRelitivesMenor3,radius),createRelatives(dataRelitivesMenor2,radius-50),createRelatives(dataRelitivesMenor1,radius-100))}0==tipeRelatives?(createRelatives(dataRelitivesMayor3,radius),createRelatives(dataRelitivesMayor2,radius-50),createRelatives(dataRelitivesMayor1,radius-100)):(createRelatives(dataRelitivesMenor3,radius),createRelatives(dataRelitivesMenor2,radius-50),createRelatives(dataRelitivesMenor1,radius-100));const svgCirculo=circuloQuintas,parentWidth=svgCirculo.node().getBoundingClientRect().width,parentHeight=svgCirculo.node().getBoundingClientRect().height,centerX=parentWidth/2,centerY=parentHeight/2,radiusDis=33,arcCenterX=centerX,arcCenterY=centerY,fontSize=20,botonDrag=(svgCirculo.append("path").attr("id","curve").attr("d",`M ${arcCenterX-radiusDis},${arcCenterY} A ${radiusDis},${radiusDis} 0 0,1 ${arcCenterX+radiusDis},`+arcCenterY).attr("fill","none").attr("stroke","none"),svgCirculo.append("text").attr("font-size",fontSize+"px").attr("fill","black").attr("stroke","none").attr("text-anchor","middle").append("textPath").attr("xlink:href","#curve").attr("startOffset","50%").text("diminished"),d3.select("#drag-boton").text(" Drag ").on("click",function(){var e=d3.select(this).classed("activo");d3.selectAll(".notesScaless").style("pointer-events",e?"all":"none"),d3.select(this).classed("activo",!e)})),modesContainer=d3.select("#modes-container").attr("style","text-align:center");let count=0;const notes2=["C","D","E","F","G","A","B"],modes=["Ionian: Brillante, feliz, optimista","Dorian: Suave, melancólico, misterioso","Phrygian: Intenso, dramático, exótico","Lydian: Brillante, exótico, aventurero","Mixolydian: Distinto, con un toque de blues, relajado","Aeolian: Oscuro, melancólico, triste","Locrian: Tenso, inquietante, disonante"],matrixContainer=d3.select("#modes-container").attr("style","text-align:center"),matrix=matrixContainer.selectAll("div").data(notes2).enter().append("div").style("display","flex").style("justify-content","center").style("align-items","center").append("div"),span=(matrix.append("div").style("font-size","12px").attr("writing-mode","vertical-lr").text(function(e,t){return e+" "+modes[t]}),matrix.selectAll("span").data(function(e,t){e=notes.indexOf(e);return notes.slice(e).concat(notes.slice(0,e))}).enter().append("span").style("position","relative").append("button").attr("class","ios-btn").style("background-color",e=>assignColor(e)).style("border-radius","0px").style("width","80px").style("opacity",function(e){return e.includes("#")?.2:1}).text(function(e,t){return e}));let currentIndexSecuence=0;function createSecuence(e){const a=e.slice().reverse();e=d3.select("#fretboard");const n=e.append("g").attr("id","noteSecuenceColor").style("fill","grey");e.append("circle").attr("id","noteSecuencia").attr("cx",-100).attr("cy",-100).attr("r",stringHeight/4).style("fill","white").style("stroke","black").style("stroke-width","1px").style("z-index",10);n.selectAll("g").data(a).enter().append("rect").attr("class","noteSecuenceColorNote").attr("x",e=>window.innerWidth/2).attr("y",e=>-height/12).attr("width",40).attr("height",30).style("fill",e=>assignColor(e.slice(0,-1))).style("paint-order","stroke").style("stroke-width",e=>"5px").style("stroke-linecap","round").style("stroke-position","inside").style("stroke-dasharray","1, 0").order((e,t)=>t).append("title").text(e=>e);let r=-1;n.selectAll(".noteSecuenceColorNote").on("click",function(){d3.select("#noteGroup").remove(),d3.select("#titulo").remove(),visualizarAcordes([]);var e=/^([A-G]#?)(\d)$/.exec(d3.select(this).datum()),t=e[1],e=e[2];sonarNota(t,e),pentagramSecuence(t,e,tonicNote,tonicNote),visualizarNota(d3.select(this).datum(),1),n.selectAll(".noteSecuenceColorNote").transition().duration(100).attr("y",(e,t)=>(t+r)*(height/12)-(a.length-2)*height/12),(r=(r+1)%a.length)==a.length-1&&(svg.select("#pentagramaNotes").remove(),n.selectAll(".noteSecuenceColorNote").transition().duration(1500).attr("x",e=>window.innerWidth/2),n.selectAll(".noteSecuenceColorNote").transition().duration(1500).attr("y",e=>-height/12-10),r=-1,++currentIndexSecuence<=sequenceFullNotes.length-1||(currentIndexSecuence=0),createSecuence(sequenceFullNotes[currentIndexSecuence]))})}function visualizarNota(t,e){var a=d3.selectAll(".noteGroupColorNote").filter(function(e){return e.note+e.octave===t}),n=parseFloat(a.attr("x")),a=parseFloat(a.attr("y"));d3.select("#noteSecuencia").attr("cx",n+fretWidth/2).attr("cy",a+stringHeight/2)}const sequenceFullNotes=[["C5","B4","C5","D5","C5","B4","A4","C5","C5","A4","C5","B4","C5","A4","G4","E4","F4","G4"],["D5","A4","B4","F#4","G4","D4","G4","A4"],["A3","C4","D4","D4","D4","E4","F4","F4","F4","G4","E4","E4","D4","C4","C4","D4"]];function pentagramSecuence(n,e,t="C"){var r=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],o=[0,0,2,2,4,6,6,8,8,10,10,12].map(e=>e*alturaRec/2),s=alturaRec*(21-7*(e-2))+x,l=r.indexOf(t),i=(svg.select("#pentagramaNotes").remove(),o[l%12],[]);for(let a=0;a<1;a++){let e=s-o[r.indexOf(n)%12],t=(r.indexOf(n)<l&&(e+=7*-alturaRec),e,octaveIN);r.indexOf(n)<l&&t++;var c=a;i.push({nota:n,altura:e,posicion:c+7*a,octava:t})}return svg.append("g").attr("id","pentagramaNotes").selectAll("circle").data(i).enter().append("circle").attr("cx",e=>e.posicion*alturaLineas+3*x).attr("cy",e=>e.altura+x).attr("r",2*alturaLineas).style("fill",(e,t)=>assignColor(e.nota)).on("click",function(e,t){e.stopPropagation(),sonarNota(t.nota,t.octava)}),i}createSecuence(sequenceFullNotes[0])</script>
</body>
</html>
